---
title: docker数据卷操作
tags:
  - docker
categories:
  - 服务器
  - docker
abbrlink: 54426
date: 2018-06-16 19:10:45
---

## 数据卷操作

### 选择 -v 还是 -–mount 参数
Docker 新用户应该选择 --mount 参数，经验丰富的 Docker 使用者对 -v 或者 --volume 已经很熟悉了，但是推荐使用 --mount 参数。
## 创建一个数据卷

``` 
$ docker volume create my-vol
```
## 查看所有数据卷

```
mk:~ mk$ docker volume ls
DRIVER VOLUME NAME
local nexus-data
```
## 查看数据卷详细信息

```
mk:~ mk$ docker volume inspect nexus-data
[
    {
        "CreatedAt": "2018-05-09T05:47:13Z",
        "Driver": "local",
        "Labels": {},
        "Mountpoint": "/var/lib/docker/volumes/nexus-data/_data",
        "Name": "nexus-data",
        "Options": {},
        "Scope": "local"
    }
]
```

## 启动一个挂载数据卷的容器
在用 docker run 命令的时候，使用 --mount 标记来将 数据卷 挂载到容器里。在一次 docker run 中可以挂载多个 数据卷。

下面创建一个名为 web 的容器，并加载一个 数据卷 到容器的 /webapp 目录。

```
$ docker run -d -P \
    --name web \
    # -v my-vol:/wepapp \
    --mount source=my-vol,target=/webapp \
    training/webapp \
    python app.py
```
## 查看数据卷的具体信息

在主机里使用以下命令可以查看 web 容器的信息

```
$ docker inspect web
```
数据卷 信息在 "Mounts" Key 下面

```
"Mounts": [
    {
        "Type": "volume",
        "Name": "my-vol",
        "Source": "/var/lib/docker/volumes/my-vol/_data",
        "Destination": "/app",
        "Driver": "local",
        "Mode": "",
        "RW": true,
        "Propagation": ""
    }
],
```

## 删除数据卷

```
docker volume rm my-vol
```


数据卷 是被设计用来持久化数据的，它的生命周期独立于容器，<font color=#A52A2A >Docker 不会在容器被删除后自动删除数据卷</font>，并且也不存在垃圾回收这样的机制来处理没有任何容器引用的 数据卷。如果需要在删除容器的同时移除数据卷。可以在删除容器的时候使用 docker rm -v 这个命令。

无主的数据卷可能会占据很多空间，要清理请使用以下命令

```
$ docker volume prune
```






