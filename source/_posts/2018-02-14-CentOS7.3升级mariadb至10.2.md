---
title:  CentOS7.3升级mariadb至10.2
date: 2018-02-14 14:34:21
tags: 
- Maria DB
- CentOS7
categories: 
- 服务器
- 数据库
---
安装gogs因为数据库版本太低只好升级数据库了，从github上得知MariaDB似乎10.2以上就可以解决问题了，只好升级了
由于CentOS7 自带数据库 版本太低了，只能升级数据库了😭
要升级原来centOS7默认带的数据库5.5，先要添加respos地址，在下面目录下新建MariaDB.repo文件

```
[root@sweet yum.repos.d]# pwd
/etc/yum.repos.d
[root@sweet yum.repos.d]# ls
CentOS-Base.repo  epel.repo  MariaDB.repo
[root@sweet yum.repos.d]#

```
在文件里写入下面的信息

```
[root@sweet yum.repos.d]# cat MariaDB.repo
\#MariaDB 10.2 CentOS repository list - created 2017-12-01 11:36 UTC
\# http://downloads.mariadb.org/mariadb/repositories/
[mariadb]
name = MariaDB
baseurl = https://mirrors.ustc.edu.cn/mariadb/yum/10.2/centos7-amd64
gpgkey=https://mirrors.ustc.edu.cn/mariadb/yum/RPM-GPG-KEY-MariaDB
gpgcheck=1
```
然后就可以安装软件了，成功之后登录名和旧数据库相同

```
[root@sweet yum.repos.d]# sudo yum install MariaDB-server MariaDB-client
Loaded plugins: fastestmirror
base                                                                               | 3.6 kB  00:00:00
epel                                                                               | 4.7 kB  00:00:00
extras                                                                             | 3.4 kB  00:00:00
mariadb                                                                            | 2.9 kB  00:00:00
updates                                                                            | 3.4 kB  00:00:00
(1/8): base/7/x86_64/group_gz                                                      | 156 kB  00:00:00
(2/8): epel/x86_64/updateinfo                                                      | 880 kB  00:00:00
(3/8): epel/x86_64/group_gz                                                        | 266 kB  00:00:00
(4/8): extras/7/x86_64/primary_db                                                  | 166 kB  00:00:00
(5/8): base/7/x86_64/primary_db                                                    | 5.7 MB  00:00:00
(6/8): epel/x86_64/primary_db                                                      | 6.2 MB  00:00:00
(7/8): updates/7/x86_64/primary_db                                                 | 6.0 MB  00:00:00
(8/8): mariadb/primary_db                                                          |  22 kB  00:00:00
Determining fastest mirrors
Resolving Dependencies
--> Running transaction check
---> Package MariaDB-client.x86_64 0:10.2.13-1.el7.centos will be installed
--> Processing Dependency: MariaDB-common for package: MariaDB-client-10.2.13-1.el7.centos.x86_64
---> Package MariaDB-server.x86_64 0:10.2.13-1.el7.centos will be installed
--> Processing Dependency: galera for package: MariaDB-server-10.2.13-1.el7.centos.x86_64
--> Processing Dependency: lsof for package: MariaDB-server-10.2.13-1.el7.centos.x86_64
--> Running transaction check
---> Package MariaDB-common.x86_64 0:10.2.13-1.el7.centos will be installed
--> Processing Dependency: MariaDB-compat for package: MariaDB-common-10.2.13-1.el7.centos.x86_64
---> Package galera.x86_64 0:25.3.23-1.rhel7.el7.centos will be installed
--> Processing Dependency: libboost_program_options.so.1.53.0()(64bit) for package: galera-25.3.23-1.rhel7.el7.centos.x86_64
---> Package lsof.x86_64 0:4.87-4.el7 will be installed
--> Running transaction check
---> Package MariaDB-compat.x86_64 0:10.2.13-1.el7.centos will be installed
---> Package boost-program-options.x86_64 0:1.53.0-27.el7 will be installed
--> Finished Dependency Resolution

Dependencies Resolved

==========================================================================================================
 Package                       Arch           Version                               Repository       Size
==========================================================================================================
Installing:
 MariaDB-client                x86_64         10.2.13-1.el7.centos                  mariadb          48 M
 MariaDB-server                x86_64         10.2.13-1.el7.centos                  mariadb         110 M
Installing for dependencies:
 MariaDB-common                x86_64         10.2.13-1.el7.centos                  mariadb         155 k
 MariaDB-compat                x86_64         10.2.13-1.el7.centos                  mariadb         2.8 M
 boost-program-options         x86_64         1.53.0-27.el7                         base            156 k
 galera                        x86_64         25.3.23-1.rhel7.el7.centos            mariadb         8.0 M
 lsof                          x86_64         4.87-4.el7                            base            331 k

Transaction Summary
==========================================================================================================
Install  2 Packages (+5 Dependent packages)

Total download size: 169 M
Installed size: 719 M
Is this ok [y/d/N]: y
Downloading packages:
warning: /var/cache/yum/x86_64/7/mariadb/packages/MariaDB-10.2.13-centos73-x86_64-common.rpm: Header V4 DSA/SHA1 Signature, key ID 1bb943db: NOKEY
Public key for MariaDB-10.2.13-centos73-x86_64-common.rpm is not installed
(1/7): MariaDB-10.2.13-centos73-x86_64-common.rpm                                  | 155 kB  00:00:00
(2/7): MariaDB-10.2.13-centos73-x86_64-compat.rpm                                  | 2.8 MB  00:00:00
(3/7): boost-program-options-1.53.0-27.el7.x86_64.rpm                              | 156 kB  00:00:00
(4/7): MariaDB-10.2.13-centos73-x86_64-client.rpm                                  |  48 MB  00:00:08
(5/7): lsof-4.87-4.el7.x86_64.rpm                                                  | 331 kB  00:00:00
(6/7): MariaDB-10.2.13-centos73-x86_64-server.rpm                                  | 110 MB  00:00:09
(7/7): galera-25.3.23-1.rhel7.el7.centos.x86_64.rpm                                | 8.0 MB  00:00:03
----------------------------------------------------------------------------------------------------------
Total                                                                      14 MB/s | 169 MB  00:00:12
Retrieving key from https://mirrors.ustc.edu.cn/mariadb/yum/RPM-GPG-KEY-MariaDB
Importing GPG key 0x1BB943DB:
 Userid     : "MariaDB Package Signing Key <package-signing-key@mariadb.org>"
 Fingerprint: 1993 69e5 404b d5fc 7d2f e43b cbcb 082a 1bb9 43db
 From       : https://mirrors.ustc.edu.cn/mariadb/yum/RPM-GPG-KEY-MariaDB
Is this ok [y/N]: y
Running transaction check
Running transaction test
Transaction test succeeded
Running transaction
  Installing : MariaDB-common-10.2.13-1.el7.centos.x86_64                                             1/7
  Installing : MariaDB-compat-10.2.13-1.el7.centos.x86_64                                             2/7
  Installing : MariaDB-client-10.2.13-1.el7.centos.x86_64                                             3/7
  Installing : boost-program-options-1.53.0-27.el7.x86_64                                             4/7
  Installing : galera-25.3.23-1.rhel7.el7.centos.x86_64                                               5/7
  Installing : lsof-4.87-4.el7.x86_64                                                                 6/7
  Installing : MariaDB-server-10.2.13-1.el7.centos.x86_64                                             7/7
  Verifying  : MariaDB-client-10.2.13-1.el7.centos.x86_64                                             1/7
  Verifying  : MariaDB-compat-10.2.13-1.el7.centos.x86_64                                             2/7
  Verifying  : lsof-4.87-4.el7.x86_64                                                                 3/7
  Verifying  : galera-25.3.23-1.rhel7.el7.centos.x86_64                                               4/7
  Verifying  : MariaDB-common-10.2.13-1.el7.centos.x86_64                                             5/7
  Verifying  : boost-program-options-1.53.0-27.el7.x86_64                                             6/7
  Verifying  : MariaDB-server-10.2.13-1.el7.centos.x86_64                                             7/7

Installed:
  MariaDB-client.x86_64 0:10.2.13-1.el7.centos        MariaDB-server.x86_64 0:10.2.13-1.el7.centos

Dependency Installed:
  MariaDB-common.x86_64 0:10.2.13-1.el7.centos        MariaDB-compat.x86_64 0:10.2.13-1.el7.centos
  boost-program-options.x86_64 0:1.53.0-27.el7        galera.x86_64 0:25.3.23-1.rhel7.el7.centos
  lsof.x86_64 0:4.87-4.el7

Complete!
```


